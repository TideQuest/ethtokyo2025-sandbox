"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ethers_1 = require("ethers");
const api_1 = require("../proto/api");
const signatures_1 = require("../utils/signatures");
const ALGS = [
    {
        title: 'ETH',
        algorithm: signatures_1.SIGNATURES[api_1.ServiceSignatureType.SERVICE_SIGNATURE_TYPE_ETH]
    }
];
describe.each(ALGS)('$title Signatures', ({ algorithm }) => {
    it('should sign & verify', async () => {
        const alice = ethers_1.Wallet.createRandom();
        const data = Buffer.from('{"a":"123","b":123}', 'utf8');
        const signature = await algorithm.sign(data, alice.privateKey);
        const addr = algorithm.getAddress(ethers_1.utils.arrayify(alice.publicKey));
        let res = await algorithm.verify(data, signature, addr);
        expect(res).toBeTruthy();
        res = await algorithm.verify(data, ethers_1.utils.hexlify(signature), addr);
        expect(res).toBeTruthy();
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC5zaWduYXR1cmVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3Rlc3RzL3Rlc3Quc2lnbmF0dXJlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1DQUFzQztBQUN0Qyx1Q0FBb0Q7QUFDcEQscURBQWlEO0FBRWpELE1BQU0sSUFBSSxHQUFHO0lBQ1o7UUFDQyxLQUFLLEVBQUUsS0FBSztRQUNaLFNBQVMsRUFBRSx1QkFBVSxDQUFDLDBCQUFvQixDQUFDLDBCQUEwQixDQUFDO0tBQ3RFO0NBQ0QsQ0FBQTtBQUVELFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxFQUFFLFNBQVMsRUFBRSxFQUFFLEVBQUU7SUFFMUQsRUFBRSxDQUFDLHNCQUFzQixFQUFFLEtBQUssSUFBRyxFQUFFO1FBRXBDLE1BQU0sS0FBSyxHQUFHLGVBQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQTtRQUVuQyxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLE1BQU0sQ0FBQyxDQUFBO1FBQ3ZELE1BQU0sU0FBUyxHQUFHLE1BQU0sU0FBUyxDQUFDLElBQUksQ0FDckMsSUFBSSxFQUNKLEtBQUssQ0FBQyxVQUFVLENBQ2hCLENBQUE7UUFFRCxNQUFNLElBQUksR0FBRyxTQUFTLENBQUMsVUFBVSxDQUFDLGNBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUE7UUFDbEUsSUFBSSxHQUFHLEdBQUcsTUFBTSxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUE7UUFFdkQsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFBO1FBQ3hCLEdBQUcsR0FBRyxNQUFNLFNBQVMsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLGNBQUssQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUE7UUFFbEUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFBO0lBQ3pCLENBQUMsQ0FBQyxDQUFBO0FBQ0gsQ0FBQyxDQUFDLENBQUEifQ==